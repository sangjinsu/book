# 자연어 처리 바이블

## 자연어 처리의 기본

### 1.1 자연어  처리란?

자연어는 사람들이 일상생활에서 사용하는 언어이다. 자연어 처리 natural language processing NLP 는 컴퓨터가 자연어를 이해하거나 생성하도록 하는 학문 분야이다. 자연어 처리는 이해와 생성이 핵심 과정이다. 

- 자연어 이해 natural language understanding NLU 
  - 자연어 입력을 목적에 따라 처리하는 과정

- 자연어 생성 natural language generation NLG
  - 정보를 바탕으로 문장을 생성하여 출력하는 과정 

---

### 1.2 자연어 처리의 응용 분야

전산 언어학은 컴퓨팅 기술을 활용하는 언어학의 하위 분야이다. 규칙 기반, 통계 기반, 딥러닝을 사용한다.

예시로는 번역기, 기사 요약 서비스, 음성 인식(Speech-To-Text, STT) 등이 있다. 

---

### 1.3 자연어 처리는 왜 어려운가?

#### 1.3.1 언어의 중의성

같은 글자에도 맥략에 따라 해석이 달리된다는 것을 중의성이라고 한다

#### 1.3.2 규칙의 예외

형태론은 언어 규칙을 연구하는 언어학의 한 분야이다. 규칙은 현상을 설명하는데 도움이 되지만 규칙에서 벗어나는 상황이 발생한다. 문법 규칙에 따르지만 의미가 형성되지 않는 경우와 숙어가 예외에 대한 대표적인 예시이다. 

#### 1.3.3 언어의 유연성과 확장성

언어는 무한하다는 특성을 가지며 유한한 단어와 소리를 조합하여 문장 수와 길이를 무한하게 늘릴 수 있다. 확장성은 언어를 모델화하여 처리하는데 불확실성을 높이는 원인이다

언어는 계속 변화하는 확장성을 가진다. 유행어, 신조어, 은어 등이 자연어 처리에서 대응하기 어렵다.

---

### 1.4 자연어 처리 연구의 패러다임

#### 1.4.1 규칙 기반

언어의 문법적인 규칙을 사전에 정의하고 규칙에 기반하여 자연어를 처리하는 방식이다

1. 핵심 단어를 사전을 통해 번역한다
2. 원본 문장에서 발견되는 문법 규칙을 찾아낸다
3. 대응하는 번역한 언어의 규칙을 찾아낸다
4. 단어와 단어 사이를 이어준다 

규칙 기반 자연어 처리의 문제점은 규칙을 사전에 직접 구축해야 한다는 것이다. 

언어 구성 규칙은 예외 사항이 많고 어순에 따라 문장이 달라지기 때문에 대응 가능한 문장 종류가 제한되고 정확도가 매우 떨어진다. 현재는 다른 방식을 보충하는 방식으로 사용된다.

#### 1.4.2 통계 기반

수학적 개념인 조건부 확률을 사용하여 자연어를 처리한다. 

1. 문장을 단어 또는 형태소별로 나눈다
2. 문장을 완성시킬 때 앞이나 뒤에 있는 단어를 통해 다음에 나올 확률이 높은 단어를 찾는다

단어 사이에 있는 통계적으로 유의미한 상관관계를 활용한다 

#### 1.4.3 딥러닝 기반

##### 기계학습

비정형 데이터가 늘어나면서 사람이 처리법, 가중치를 계산하는 것이 불가능해졌다.

기계학습은 알고리즘 개발이 불가능할 때 문제 해결을 하기 위한 방법이다. 입력 데이터를 사용해 알고리즘이 스스로 연산의 가중치를 결정하는 방식이다. 훈련은 입력 데이터를 통해 가중치가 계속 업데이트 되는 과정이다. 모델은 훈련을 한 사용 가능한 알고리즘이다. 

인공 신경망은 입력 벡터의 각 값에 가중치를 곱하고 확성 함수를 통과 시키고 다음에 연결된 뉴런으로 전달하는 과정이다

##### 딥러닝

인공 신경망 구조에서 뉴런의 층 수가 여러 개로 만든 것이다. 가중치 개수가 너무 많아 가중치가 어떤 의미를 가지는지 알 수 없다. 이를 블랙박스라고 한다. 하지만 성능이 매우 상승하였다.

- 통계 기반 자연어 처리는 단어들 간의 등장 빈도 같은 일차적 분석을 기반으로 한다
- 딥러닝 기반 자연어 처리는 여러 데이터 사이에 복합적인 연결을 통해 심층적인 분석을 기반으로 한다

---

### 1.5 딥러닝을 사용하는 자연어 처리 연구

1. 어떤 목적으로 자연어 처리를 도입할 것인지 결정한다
2. 학습 데이터(코퍼스)를 구축하거나 확보한다
3. 학습 데이터를 통해 학습시킬 모델을 작성한다
4. 모델을 코퍼스를 이용해 학습시킨다
5. 학습된 모델을 검증하고 문제가 있을 경우 2 - 4 단계로 돌아간다
6. 완성된 모델을 활용한다 

모델의 성능은 2, 3 단계에서 가장 많이 영향을 받는다 

#### 1.5.1 단어 임베딩

자연어로 되어있는 문장을 컴퓨터가 이해할 수 있도록 문장을 전처리하는 과정 중 하나이다. 

단어(형태소) 단위로 문장을 분해할 때 많이 사용되며 각 단어(형태소)를 벡터로 변환한다. 

#### 1.5.2 코퍼스

우리말로 말뭉치라고 하며 통계나 딥러닝 기반의 자연어 처리에 사용되는 큰 크기의 문장 모음이다. 목적에 따라 데이터, 문장 성격, 특성, 다른 언어 문장을 추가하기도 한다. 딥러닝 성능은 데이터 품질에 영향을 많이 받기 때문에 코퍼스는 중요하다.

#### 1.5.3 모델

모델 구축은 어떤 학습 과정을 거치게 하는지에 대한 고민이다. 목적에 따라 입력 데이터와 출력 데이터를 결정한다.

---

1.  자연어 처리가 다른 전산학 과제들과 비교했을 때 특히 어려운 이유는?
   - 언어는 중의성, 유연성, 확장성을 가지고 규칙에서 벗어나는 상황이 많다. 맥락에 따라 문장은 의도가 달라진다. 그리고 단어와 문장의 조합으로 무한히 확장이 가능하고 빠르게 단어가 생겨나고 사라진다. 
2. 통계 기반과 딥러닝 기반 자연어 처리에서 필요로 하는 많은 수의 문장을 모아 놓은 데이터를 부르는 말은?
   - 코퍼스
3. 규칙 기반 자연어 처리가 외면 받은 이유는 무엇인가?
   - 규칙을 먼저 사전에 직접 구축해야 한다. 언어 구성 규칙은 예외 사항이 많고 어순에 따라 문장이 달라지기 때문에 대응 가능한 문장 종류가 제한되고 정확도가 떨어진다는 한계점을 가지기 때문이다.
4. 딥러닝에서 모델을 제안한 사람은 은닉층 안의 측정 가중치가 무엇을 왜 계산하는지 설명할 수 있는가?
   - 측정 가중치는 블랙박스 형태로 어떤 의미를 가졌는지 알 수 없다.
5. 일상 속에서 찾아볼 수 있는 자연어 처리 기술이 적용된 예시를 들고, NLU, NLG 중 어느 부분이 사용되었는지 설명해보자.
   - 삼성 빅스비, 애플 시리, SK NUGU 는 질문을 이해하고 답변에 해당하는 음성이나 문장을 보여준다. 질문 이해 과정은 음성 인식으로 NLU 에 속한다. 그리고 질문에 대한 음성 답변이나 문장을 보여주는 형식으로 NLG 가 사용되었다. 